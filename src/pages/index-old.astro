---
/**
 * index.astro
 * Landing page con AOS animations y config centralizado
 */

export const prerender = true;

import BaseLayout from '../layouts/BaseLayout.astro';
import Navbar from '../components/Navbar.astro';
import ServiceCard from '../components/ServiceCard.astro';
import TestimonialCard from '../components/TestimonialCard.astro';
import PricingCard from '../components/PricingCard.astro';
import CTASection from '../components/CTASection.astro';
import Footer from '../components/Footer.astro';
import { site } from '../data/config.js';
---

<BaseLayout
  title="Inicio"
  description={site.seo.defaultDescription}
  keywords={site.seo.keywords}
>
  <Navbar />

  <!-- Hero Section con AOS -->
  <section class="relative pt-12 md:pt-20 pb-16 md:pb-24 px-4 overflow-hidden min-h-[80vh] flex items-center">
    <!-- Fondo decorativo con ondas animadas -->
    <div class="absolute inset-0 overflow-hidden pointer-events-none">
      <div class="absolute inset-0 bg-gradient-to-br from-brand-50/80 via-white to-accent-50/60"></div>
      
      <!-- Elementos flotantes mejorados -->
      <div class="absolute top-20 right-10 w-72 h-72 bg-brand-400/20 rounded-full blur-3xl animate-wave" style="animation-delay: 0s;"></div>
      <div class="absolute bottom-20 left-10 w-96 h-96 bg-accent-400/15 rounded-full blur-3xl animate-wave" style="animation-delay: 7s;"></div>
      <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-brand-300/10 rounded-full blur-2xl animate-pulse-slow"></div>
      
      <!-- Grid pattern -->
      <div class="absolute inset-0 opacity-5" style="background-image: radial-gradient(circle, #2563eb 1px, transparent 1px); background-size: 50px 50px;"></div>
    </div>

    <div class="max-w-7xl mx-auto relative z-10 w-full">
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
        <!-- Columna izquierda con AOS -->
        <div class="space-y-8">
          <div 
            data-aos="fade-up"
            data-aos-delay="100"
            class="inline-block px-4 py-2 bg-gradient-to-r from-brand-100 to-accent-100 text-brand-700 rounded-full text-sm font-semibold shadow-sm hover:shadow-md transition-shadow duration-300"
          >
            {site.hero.badge}
          </div>
          
          <h1 
            data-aos="fade-up"
            data-aos-delay="200"
            style="animation-delay: 0.1s;"
            class="text-4xl md:text-5xl lg:text-6xl font-heading font-bold text-gray-900 leading-tight"
          >
            {site.hero.title}
            <span class="text-gradient bg-gradient-to-r from-brand-600 via-brand-500 to-accent-600 block mt-2">{site.hero.titleHighlight}</span>
          </h1>
          
          <p 
            data-aos="fade-up"
            data-aos-delay="300"
            class="text-lg md:text-xl text-gray-600 leading-relaxed max-w-xl"
          >
            {site.hero.subtitle}
          </p>

          <!-- CTAs con AOS -->
          <div 
            data-aos="zoom-in"
            data-aos-delay="400"
            class="flex flex-col sm:flex-row gap-4"
          >
            <a
              href={site.hero.ctaPrimary.link}
              class="group inline-flex items-center justify-center px-8 py-4 bg-brand-600 text-white rounded-xl font-semibold text-lg hover:bg-brand-700 hover:shadow-brand-lg transition-all duration-300 shadow-brand hover:-translate-y-1 animate-pulse-btn"
            >
              {site.hero.ctaPrimary.text}
              <svg class="w-5 h-5 ml-2 group-hover:translate-x-1 transition-transform duration-300" fill="none" strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" viewBox="0 0 24 24" stroke="currentColor">
                <path d="M17 8l4 4m0 0l-4 4m4-4H3"/>
              </svg>
            </a>
            <a
              href={site.hero.ctaSecondary.link}
              class="inline-flex items-center justify-center px-8 py-4 bg-white text-brand-600 border-2 border-brand-600 rounded-xl font-semibold text-lg hover:bg-brand-50 hover:border-brand-700 hover:text-brand-700 hover:shadow-lg transition-all duration-300 hover:-translate-y-1"
            >
              {site.hero.ctaSecondary.text}
            </a>
          </div>

          <!-- Stats con AOS -->
          <div 
            data-aos="fade-up"
            data-aos-delay="500"
            class="flex flex-wrap gap-8 pt-8"
          >
            {site.hero.stats.map((stat) => (
              <div class="group">
                <div class="text-3xl md:text-4xl font-bold text-brand-600 group-hover:scale-110 transition-transform duration-300">{stat.value}</div>
                <div class="text-sm text-gray-600 font-medium">{stat.label}</div>
              </div>
            ))}
          </div>
        </div>

        <!-- Columna derecha con AOS -->
        <div 
          data-aos="fade-left"
          data-aos-delay="300"
          class="relative lg:ml-8"
        >
          <div class="relative rounded-2xl overflow-hidden shadow-2xl hover:shadow-brand-lg transition-all duration-500 hover:-translate-y-2 group">
            <img
              src={site.hero.image}
              alt={site.hero.imageAlt}
              class="w-full h-[400px] lg:h-[500px] object-cover group-hover:scale-105 transition-transform duration-700"
              loading="eager"
              width="800"
              height="500"
            />
            <div class="absolute inset-0 bg-gradient-to-t from-brand-900/30 via-transparent to-transparent group-hover:from-brand-900/40 transition-colors duration-500"></div>
            
            <!-- Badge flotante -->
            {site.hero.badge2.active && (
              <div class="absolute bottom-6 left-6 bg-white/95 backdrop-blur-sm px-4 py-3 rounded-xl shadow-lg animate-bounce-subtle">
                <div class="flex items-center space-x-2">
                  <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                  <span class="text-sm font-semibold text-gray-800">{site.hero.badge2.text}</span>
                </div>
              </div>
            )}
          </div>
          
          <!-- Decoración flotante -->
          <div class="absolute -bottom-6 -right-6 w-32 h-32 bg-gradient-to-br from-brand-600 to-brand-700 rounded-2xl transform rotate-12 -z-10 opacity-20 animate-wave"></div>
          <div class="absolute -top-6 -left-6 w-32 h-32 bg-gradient-to-br from-accent-600 to-accent-700 rounded-2xl transform -rotate-12 -z-10 opacity-20 animate-wave" style="animation-delay: 10s;"></div>
          
          <!-- Glow effect -->
          <div class="absolute inset-0 -z-10 rounded-2xl bg-gradient-to-r from-brand-600 to-accent-600 blur-2xl opacity-20 animate-glow"></div>
        </div>
      </div>
    </div>
  </section>

  <!-- Servicios Destacados con AOS -->
  <section class="py-16 md:py-24 px-4 bg-gray-50" id="servicios">
    <div class="max-w-7xl mx-auto">
      <!-- Header con AOS -->
      <div class="text-center mb-12 md:mb-16" data-aos="fade-up">
        <h2 class="text-3xl md:text-4xl lg:text-5xl font-heading font-bold text-gray-900 mb-4">
          Servicios Profesionales
        </h2>
        <p class="text-lg md:text-xl text-gray-600 max-w-2xl mx-auto">
          Soluciones digitales diseñadas específicamente para pequeñas y medianas empresas
        </p>
      </div>

      <!-- Grid de servicios con delays escalonados -->
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8">
        {site.services.filter(s => s.featured).map((service, index) => (
          <div data-aos="fade-up" data-aos-delay={100 * (index + 1)}>
            <ServiceCard
              title={service.title}
              description={service.description}
              icon={service.icon}
              link={service.link}
            />
          </div>
        ))}
      </div>

      <!-- CTA intermedio con AOS -->
      <div 
        class="mt-16 text-center bg-gradient-to-r from-brand-50 to-accent-50 rounded-2xl p-8 md:p-12"
        data-aos="zoom-in"
        data-aos-delay="400"
      >
        <h3 class="text-2xl md:text-3xl font-bold text-gray-900 mb-4">
          ¿Listo para empezar?
        </h3>
        <p class="text-gray-600 mb-6 max-w-xl mx-auto">
          Agenda una reunión gratuita y descubre cómo podemos ayudarte a crecer
        </p>
        <a
          href="/contacto"
          class="inline-flex items-center px-8 py-4 bg-brand-600 text-white rounded-xl font-semibold text-lg hover:bg-brand-700 hover:shadow-brand-lg transition-all duration-300 hover:-translate-y-1 animate-pulse-btn"
        >
          Cotizar Proyecto
          <svg class="w-5 h-5 ml-2" fill="none" strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" viewBox="0 0 24 24" stroke="currentColor">
            <path d="M17 8l4 4m0 0l-4 4m4-4H3"/>
          </svg>
        </a>
      </div>

      <!-- Link a todos los servicios -->
      <div class="text-center mt-12" data-aos="fade-up" data-aos-delay="500">
        <a
          href="/servicios"
          class="inline-flex items-center text-brand-600 font-semibold text-lg hover:text-brand-700 transition-colors group"
        >
          Ver todos los servicios
          <svg class="w-5 h-5 ml-2 group-hover:translate-x-1 transition-transform" fill="none" strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" viewBox="0 0 24 24" stroke="currentColor">
            <path d="M17 8l4 4m0 0l-4 4m4-4H3"/>
          </svg>
        </a>
      </div>
    </div>
  </section>

  <!-- Testimonios Slider con AOS -->
  <section class="py-16 md:py-24 px-4 bg-gradient-to-b from-white to-gray-50" id="testimonios">
    <div class="max-w-7xl mx-auto">
      <!-- Header con AOS -->
      <div class="text-center mb-12 md:mb-16" data-aos="fade-up">
        <h2 class="text-3xl md:text-4xl lg:text-5xl font-heading font-bold text-gray-900 mb-4">
          Lo Que Dicen Mis Clientes
        </h2>
        <p class="text-lg md:text-xl text-gray-600 max-w-2xl mx-auto">
          Testimonios reales de negocios que han confiado en mis servicios
        </p>
      </div>

      <!-- Slider Container con AOS -->
      <div class="relative" data-aos="fade-up" data-aos-delay="200">
        <!-- Slider Wrapper con scroll-snap -->
        <div 
          id="testimonial-slider"
          class="flex overflow-x-auto gap-6 pb-8 snap-x snap-mandatory scroll-smooth scrollbar-hide"
          style="scroll-padding: 0 1.5rem; -webkit-overflow-scrolling: touch;"
        >
          {site.testimonials.map((testimonial, index) => (
            <div 
              class="min-w-full md:min-w-[calc(50%-12px)] lg:min-w-[calc(33.333%-16px)] snap-center"
              data-slide={index}
            >
              <TestimonialCard
                name={testimonial.name}
                role={testimonial.role}
                city={testimonial.city}
                text={testimonial.text}
                image={testimonial.image}
                rating={testimonial.rating}
              />
            </div>
          ))}
        </div>

        <!-- Navigation Arrows -->
        <button
          id="prev-btn"
          class="hidden md:flex absolute left-0 top-1/2 -translate-y-1/2 -translate-x-4 w-12 h-12 items-center justify-center bg-white rounded-full shadow-lg hover:shadow-brand hover:bg-brand-600 hover:text-white transition-all duration-300 z-10 group disabled:opacity-50 disabled:cursor-not-allowed"
          aria-label="Testimonio anterior"
        >
          <svg class="w-6 h-6 group-hover:-translate-x-0.5 transition-transform" fill="none" strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" viewBox="0 0 24 24" stroke="currentColor">
            <path d="M15 19l-7-7 7-7"/>
          </svg>
        </button>
        
        <button
          id="next-btn"
          class="hidden md:flex absolute right-0 top-1/2 -translate-y-1/2 translate-x-4 w-12 h-12 items-center justify-center bg-white rounded-full shadow-lg hover:shadow-brand hover:bg-brand-600 hover:text-white transition-all duration-300 z-10 group disabled:opacity-50 disabled:cursor-not-allowed"
          aria-label="Siguiente testimonio"
        >
          <svg class="w-6 h-6 group-hover:translate-x-0.5 transition-transform" fill="none" strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" viewBox="0 0 24 24" stroke="currentColor">
            <path d="M9 5l7 7-7 7"/>
          </svg>
        </button>

        <!-- Navigation Dots -->
        <div class="flex justify-center gap-2 mt-8" id="dots-container">
          {site.testimonials.map((_, index) => (
            <button
              class="testimonial-dot w-2.5 h-2.5 rounded-full bg-gray-300 hover:bg-brand-400 transition-all duration-300"
              data-index={index}
              aria-label={`Ir a testimonio ${index + 1}`}
            ></button>
          ))}
        </div>
      </div>
    </div>
  </section>

  <script>
    // Testimonial Slider Logic
    const slider = document.getElementById('testimonial-slider');
    const prevBtn = document.getElementById('prev-btn');
    const nextBtn = document.getElementById('next-btn');
    const dots = document.querySelectorAll('.testimonial-dot');
    
    if (slider && prevBtn && nextBtn) {
      let currentIndex = 0;
      const slides = slider.querySelectorAll('[data-slide]');
      const totalSlides = slides.length;

      // Get visible slides based on viewport
      const getVisibleSlides = () => {
        if (window.innerWidth >= 1024) return 3;
        if (window.innerWidth >= 768) return 2;
        return 1;
      };

      // Update dots
      const updateDots = () => {
        dots.forEach((dot, index) => {
          if (index === currentIndex) {
            dot.classList.add('bg-brand-600', 'w-8');
            dot.classList.remove('bg-gray-300', 'w-2.5');
          } else {
            dot.classList.remove('bg-brand-600', 'w-8');
            dot.classList.add('bg-gray-300', 'w-2.5');
          }
        });
      };

      // Scroll to slide
      const scrollToSlide = (index: number) => {
        const slide = slides[index] as HTMLElement;
        if (slide) {
          slider.scrollTo({
            left: slide.offsetLeft - parseFloat(getComputedStyle(slider).paddingLeft),
            behavior: 'smooth'
          });
          currentIndex = index;
          updateDots();
          updateButtons();
        }
      };

      // Update button states
      const updateButtons = () => {
        const visibleSlides = getVisibleSlides();
        const maxIndex = Math.max(0, totalSlides - visibleSlides);
        
        if (prevBtn && nextBtn) {
          prevBtn.disabled = currentIndex === 0;
          nextBtn.disabled = currentIndex >= maxIndex;
        }
      };

      // Navigation
      prevBtn.addEventListener('click', () => {
        if (currentIndex > 0) {
          scrollToSlide(currentIndex - 1);
        }
      });

      nextBtn.addEventListener('click', () => {
        const visibleSlides = getVisibleSlides();
        const maxIndex = totalSlides - visibleSlides;
        if (currentIndex < maxIndex) {
          scrollToSlide(currentIndex + 1);
        }
      });

      // Dots navigation
      dots.forEach((dot, index) => {
        dot.addEventListener('click', () => {
          scrollToSlide(index);
        });
      });

      // Auto-scroll (optional, every 5 seconds)
      let autoScrollInterval = setInterval(() => {
        const visibleSlides = getVisibleSlides();
        const maxIndex = totalSlides - visibleSlides;
        if (currentIndex < maxIndex) {
          scrollToSlide(currentIndex + 1);
        } else {
          scrollToSlide(0);
        }
      }, 5000);

      // Pause auto-scroll on hover
      slider.addEventListener('mouseenter', () => {
        clearInterval(autoScrollInterval);
      });

      slider.addEventListener('mouseleave', () => {
        autoScrollInterval = setInterval(() => {
          const visibleSlides = getVisibleSlides();
          const maxIndex = totalSlides - visibleSlides;
          if (currentIndex < maxIndex) {
            scrollToSlide(currentIndex + 1);
          } else {
            scrollToSlide(0);
          }
        }, 5000);
      });

      // Update on resize
      window.addEventListener('resize', () => {
        updateButtons();
      });

      // Initialize
      updateDots();
      updateButtons();
    }
  </script>

  <style>
    /* Hide scrollbar but keep functionality */
    .scrollbar-hide::-webkit-scrollbar {
      display: none;
    }
    .scrollbar-hide {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
  </style>

  <!-- 💰 Planes y Precios -->
  <section class="py-20 md:py-28 bg-gradient-to-br from-neutral-50 via-white to-brand-50/30 relative overflow-hidden">
    <!-- Background decoration -->
    <div class="absolute top-20 right-10 w-72 h-72 bg-brand-100 rounded-full blur-3xl opacity-20 animate-wave"></div>
    <div class="absolute bottom-20 left-10 w-96 h-96 bg-accent-100 rounded-full blur-3xl opacity-20 animate-wave" style="animation-delay: 7s;"></div>
    
    <div class="container-custom">
      <!-- Header -->
      <div class="text-center max-w-3xl mx-auto mb-16" data-aos="fade-up">
        <span class="inline-block px-4 py-1.5 bg-brand-100 text-brand-700 rounded-full text-sm font-semibold mb-4">
          💎 Planes y Precios
        </span>
        <h2 class="text-4xl md:text-5xl font-bold text-neutral-900 mb-4">
          Elige el plan <span class="text-gradient">perfecto para ti</span>
        </h2>
        <p class="text-lg text-neutral-600">
          Soluciones flexibles adaptadas a cada etapa de tu negocio
        </p>
      </div>

      <!-- Pricing Cards Grid -->
      <div class="grid md:grid-cols-3 gap-8 max-w-6xl mx-auto">
        {site.plans.map((plan) => (
          <PricingCard
            name={plan.name}
            price={plan.price}
            period={plan.period}
            description={plan.description}
            features={plan.features}
            cta={plan.cta}
            link={plan.link}
            popular={plan.popular}
            featured={plan.featured}
          />
        ))}
      </div>

      <!-- Nota adicional -->
      <div class="text-center mt-12" data-aos="fade-up" data-aos-delay="300">
        <p class="text-neutral-600 mb-4">¿Necesitas algo personalizado?</p>
        <a href="/contacto" class="inline-flex items-center gap-2 text-brand-600 font-semibold hover:gap-3 transition-all duration-300">
          Hablemos de tu proyecto
          <svg class="w-5 h-5" fill="none" strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" viewBox="0 0 24 24" stroke="currentColor">
            <path d="M13 7l5 5m0 0l-5 5m5-5H6"/>
          </svg>
        </a>
      </div>
    </div>
  </section>

  <!-- CTA Final -->
  <CTASection
    title="¿Listo para transformar tu negocio?"
    subtitle="Agenda una reunión sin compromiso y conversemos sobre cómo puedo ayudarte a alcanzar tus objetivos digitales"
    buttonText="Contactar Ahora"
    buttonLink="/contacto"
    secondaryButtonText="Ver Portfolio"
    secondaryButtonLink="/servicios"
  />

  <Footer />
</BaseLayout>

